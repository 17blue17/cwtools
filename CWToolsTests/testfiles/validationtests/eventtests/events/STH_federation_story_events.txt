namespace = sht



country_event = {
	id = STH_federation_story.2200
	title = "STH_federation_story.2200.name"
	desc = "STH_federation_story.2200.desc"
	picture = sth_GFX_evt_whaleprobe1
	location = event_target:whaleProbeSpawnPlanet
	trigger = {
		
		has_country_flag = united_federation_of_planets
		any_owned_planet = {
			has_planet_flag = sol_earth
		}
		NOR = {
			has_country_flag = whale_probe_crisis 
			has_country_flag = wrath_of_khan_era_crisis_ongoing
		}
		is_country_type = default
		
		any_system = {		
			any_planet = {
				exists = owner
				owner = { is_same_value = root }
			}
			distance = {
				source = root.capital_scope.solar_system
				min_distance = 25
				max_distance = 500
			}
		}
	}
	mean_time_to_happen = { months = 24 }
	immediate = {
		random_owned_planet = {
			limit = { 
				has_planet_flag = sol_earth 
				is_planet_class = pc_continental
			}
			save_event_target_as = earth
		}
		set_country_flag = whale_probe_crisis
		set_timed_country_flag = { flag = wrath_of_khan_era_crisis_ongoing days = 2400 }
		random_country = { 
			limit = { 
				OR = {
					has_country_flag = united_federation_of_planets 
					earth_empires = yes
				}
			}
			save_event_target_as = united_federation_of_planets
		}
		if = {
			limit = {
				any_system = {
					any_planet = { 
						exists = owner
						owner = { is_same_value = root }
					}
					any_planet = { 
						NOT = { exists = owner }
						is_star = no
					}
					distance = {
						source = root.capital_scope.solar_system
						min_distance = 25
						max_distance = 500
					}
				}
			}
			random_system = {
				limit = {
					NOT = { any_planet = { is_capital = yes } }
					any_planet = { 
						exists = owner
						owner = { is_same_value = root }
					}
					any_planet = { 
						NOT = { exists = owner }
						is_star = no
					}
					distance = {
						source = root.capital_scope.solar_system
						min_distance = 25
						max_distance = 500
					}
				}
				save_global_event_target_as = whaleProbeSpawnSystem
			}
			else = {
				random_system = {
					limit = {
						NOT = { any_planet = { is_capital = yes } }
						distance = {
							source = root.capital_scope.solar_system
							min_distance = 25
							max_distance = 100
						}
					}
					save_global_event_target_as = whaleProbeSpawnSystem
				}
			}
		}
		event_target:whaleProbeSpawnSystem = {
			random_system_planet = {
				limit = { 
					NOT = { exists = owner }
					is_star = no
				}
				save_global_event_target_as = whaleProbeSpawnPlanet
				create_whale_probe_country = yes
				event_target:whale_probe_country = {
					create_fleet = {
						settings = { spawn_debris = no is_boss = yes }
						name = "Alien Vessel"
						effect = {
							set_owner = event_target:whale_probe_country
							create_ship = {
								name = ""
								design = "Whale Probe"
							}
							set_location = event_target:whaleProbeSpawnPlanet
						}
					}
					last_created_fleet = {
						set_fleet_flag = whale_probe_fleet
						save_global_event_target_as = whale_probe_fleet
						fleet_event = { id = STH_federation_story.2202 days = 360 } 
					}
				}
			}
		}
		event_target:whaleProbeSpawnSystem = {
			random_fleet_in_system = {
				limit = {
					owner = { is_same_value = root }
					is_ship_class = shipclass_science_ship
				}
				save_event_target_as = whaleProbeSpawnSystemScienceShip
			}
		}
		every_country = {
			limit = { 
				any_owned_planet = { distance = { source = event_target:whaleProbeSpawnPlanet max_distance = 100 } }
				NOT = { is_same_value = Root }
			}
			country_event = { id = STH_federation_story.2201 }
		}
		random_list = {
			75 = { change_variable = { which = "original_series_era_crisis" value = 2 } }
			25 = { change_variable = { which = "original_series_era_crisis" value = 1 } }
		}
	}
	option = {
		name = STH_federation_story.2200.a
		trigger = { NOT = { exists = event_target:whaleProbeSpawnSystemScienceShip } }
	}
	option = {
		name = STH_federation_story.2200.b
		trigger = { exists = event_target:whaleProbeSpawnSystemScienceShip }
		country_event = { id = STH_federation_story.2204 }
	}
}



country_event = {
	id = STH_federation_story.2201
	title = "STH_federation_story.2201.name"
	desc = "STH_federation_story.2201.desc"
	picture = sth_GFX_evt_whaleprobe1
	is_triggered_only = yes
	immediate = { }
	option = { name = STH_federation_story.2201.a }
}



fleet_event = {
	id = STH_federation_story.2202
	hide_window = yes
	trigger = { }
	is_triggered_only = yes
	immediate = {
		random_country = { 
			limit = { 
				OR = {
					has_country_flag = united_federation_of_planets 
					earth_empires = yes
				}
			}
			save_event_target_as = united_federation_of_planets
		}
		queue_actions = {
			find_closest_system = {
				trigger = {
					id = "STH_federation_story.2203.trigger.1"
					any_planet = { has_planet_flag = sol_earth }
				}
				found_system = { move_to = THIS }
			}
			find_closest_planet = {
				trigger = {
					id = "STH_federation_story.2202.trigger.2"
					has_planet_flag = sol_earth
				}
				found_planet = { orbit_planet = THIS }
			}
			effect = {
				id = "STH_federation_story.2202.effect.1"
				ROOT = { 
					fleet_event = { id = STH_federation_story.2209 }
				}
			}
		}
	}
}


fleet_event = {
	id = STH_federation_story.2203
	hide_window = yes
	trigger = { 
		is_ship_class = shipclass_science_ship
		exists = from
		from = { any_ship_in_system = { fleet = { has_fleet_flag = whale_probe_fleet } } }
		from = { is_same_value = event_target:whaleProbeSpawnSystem }
		exists = owner
		owner = {
			OR = {
				has_country_flag = united_federation_of_planets
				earth_empires = yes
			}
		}
	}
	is_triggered_only = yes
	fire_only_once = yes
	immediate = {
		save_event_target_as = whaleProbeDiscoveringScienceShip
		if = { limit = { exists = leader } leader = { save_event_target_as = whaleProbeDiscoveringScienceShipLeader } }
		owner = { country_event = { id = STH_federation_story.2204 } }
	}
}


country_event = {
	id = STH_federation_story.2204
	title = "STH_federation_story.2204.name"
	desc = "STH_federation_story.2204.desc"
	picture = sth_GFX_evt_whaleprobe1
	is_triggered_only = yes
	trigger = { NOT = { has_country_flag = whale_probe_communicated } }
	immediate = { set_country_flag = whale_probe_communicated }
	option = { 
		name = STH_federation_story.2204.a 
		hidden_effect = { country_event = { id = STH_federation_story.2205 days = 2 } }
	}
	option = { 
		name = STH_federation_story.2204.b 
		hidden_effect = { 
			event_target:whale_probe_country = { set_faction_hostility = { set_hostile = yes } }
		}
	}
}


country_event = {
	id = STH_federation_story.2205
	title = "STH_federation_story.2205.name"
	desc = "STH_federation_story.2205.desc"
	picture = sth_GFX_evt_whaleprobe1
	is_triggered_only = yes
	immediate = { }
	option = { 
		name = STH_federation_story.2205.a 
		hidden_effect = { country_event = { id = STH_federation_story.2206 days = 2 } }
	}
	option = { 
		name = STH_federation_story.2205.b 
		trigger = { 
			exists = event_target:whaleProbeDiscoveringScienceShipLeader
			event_target:whaleProbeDiscoveringScienceShipLeader = {
				OR = { is_species = "xindi_aquatic" is_species = "Xindi-Aquatic" }
			}
		}
		hidden_effect = { country_event = { id = STH_federation_story.2214 days = 2 } }
	}
	option = { 
		name = STH_federation_story.2205.c 
		
			event_target:whale_probe_country = { set_faction_hostility = { set_hostile = yes } } 
		
	}
}


country_event = {
	id = STH_federation_story.2206
	title = "STH_federation_story.2206.name"
	desc = "STH_federation_story.2206.desc"
	picture = sth_GFX_evt_whaleprobe1
	is_triggered_only = yes
	immediate = { }
	option = { 
		name = STH_federation_story.2206.a 
		add_society_research = 100
	}
}


country_event = {
	id = STH_federation_story.2214
	title = "STH_federation_story.2214.name"
	desc = "STH_federation_story.2214.desc"
	picture = sth_GFX_evt_whaleprobe1
	is_triggered_only = yes
	immediate = { }
	option = { 
		name = STH_federation_story.2206.a 
		add_society_research = 500
		set_global_flag = xindi_aquatic_whale_probe_interact
	}
}


fleet_event = {
	id = STH_federation_story.2207
	hide_window = yes
	trigger = { 
		exists = event_target:whale_probe_fleet
		is_same_value = event_target:whale_probe_fleet
		exists = from
		any_country = {
			OR = {
				earth_empires = yes 
				has_country_flag = united_federation_of_planets
			}
			any_owned_planet = {
				solar_system = { is_same_value = from }
				has_planet_flag = sol_earth
			}
		}
	}
	is_triggered_only = yes
	fire_only_once = yes
	immediate = {
		random_country = { 
			limit = { 
				OR = {
					has_country_flag = united_federation_of_planets 
					earth_empires = yes
				}
			}
			save_event_target_as = united_federation_of_planets
			country_event = { id = STH_federation_story.2208 }
		}
		owner = { set_faction_hostility = { set_hostile = no } }
	}
}


country_event = {
	id = STH_federation_story.2208
	title = "STH_federation_story.2208.name"
	desc = { 
		trigger = { NOT = { has_country_flag = whale_probe_communicated } }
		text = "STH_federation_story.2208.desc_01" 
	}
	desc = { 
		trigger = { has_country_flag = whale_probe_communicated event_target:whale_probe_country = { is_hostile = root } }
		text = "STH_federation_story.2208.desc_02" 
	}
	desc = { 
		trigger = { has_country_flag = whale_probe_communicated event_target:whale_probe_country = { NOT = { is_hostile = root } } }
		text = "STH_federation_story.2208.desc_03" 
	}
	picture = sth_GFX_evt_whaleprobe1
	is_triggered_only = yes
	immediate = { }
	option = { 
		name = STH_federation_story.2208.a 
		trigger = { NOT = { has_country_flag = whale_probe_communicated } }
		hidden_effect = {
			event_target:whale_probe_country = { set_faction_hostility = { set_hostile = no } }
			country_event = { id = STH_federation_story.2206 days = 2 }
		}
	}
	option = { 
		name = STH_federation_story.2208.b 
		trigger = { 
			has_country_flag = whale_probe_communicated 
			event_target:whale_probe_country = { NOT = { is_hostile = root } }
		}
		hidden_effect = { event_target:whale_probe_country = { set_faction_hostility = { set_hostile = no } } }
	}
	option = { 
		name = STH_federation_story.2208.c 
		hidden_effect = { event_target:whale_probe_country = { set_faction_hostility = { set_hostile = yes } } }
	}
}



fleet_event = {
	id = STH_federation_story.2209
	hide_window = yes
	trigger = { 
		has_fleet_flag = whale_probe_fleet
		exists = orbit
		orbit = {
			has_planet_flag = sol_earth
			exists = owner
			owner = {
				OR = {
					earth_empires = yes 
					has_country_flag = united_federation_of_planets
				}
			}
		}
	}
	is_triggered_only = yes
	immediate = {
		solar_system = {
			random_system_planet  = {
				limit = { is_star = yes }
				set_planet_flag = whaleProbeTimeTravelStar
				save_event_target_as = timeTravelStar
			}
		}
		orbit = {
			if = {
				limit = { check_variable = { which = "whale_probe_search"  value > 99 } }
				planet_event = { id = STH_federation_story.2212 }
				else = {
					random_list = {
						10 = { planet_event = { id = STH_federation_story.2210 } }
						10 = { planet_event = { id = STH_federation_story.2211 } }
					}
				}
			}
			owner = {		
				if = {
					limit = { 
						NOT = { has_special_project = "WHALE_PROBE_1_PROJECT" } 
						NOT = { has_country_flag = whale_probe_crisis_resolved_peacefully }
						NOT = { has_country_flag = whale_probe_crisis_resolved_forcefully }
					}
					enable_special_project = { name = "WHALE_PROBE_1_PROJECT" location = event_target:timeTravelStar owner = this }
					country_event = { id = STH_federation_story.2213 days = 1}
				}
			}
		}
		fleet_event = { id = STH_federation_story.2209 days = 45 random = 30 }
	}
}


planet_event = {
	id = STH_federation_story.2210
	title = "STH_federation_story.2210.name"
	desc = { 
		trigger = { NOT = { owner = { has_country_flag = whale_probe_communicated } } }
		text = "STH_federation_story.2210.desc_01" 
	}
	picture = sth_GFX_evt_whaleprobe2
	is_triggered_only = yes
	trigger = { 
		event_target:whale_probe_fleet = { is_in_combat = no } 
	}
	immediate = { 
		change_variable = { which = "whale_probe_search" value = 10 }
		random_country = {
			limit = { has_country_flag = whale_probe_country }
			save_event_target_as = whale_probe_country
		}
	}
	option = { 
		name = STH_federation_story.2210.a 
		trigger = { event_target:whale_probe_country = { NOT = { is_hostile = root.owner } } }
		ai_chance = { factor = 0 modifier = { factor = 10 event_target:whale_probe_country = { NOT = { is_hostile = root.owner } } } }
		hidden_effect = { event_target:whale_probe_country = { set_faction_hostility = { set_hostile = no } } }
	}
	option = { 
		name = STH_federation_story.2210.b 
		trigger = { event_target:whale_probe_country = { NOT = { is_hostile = root.owner } } }
		ai_chance = { factor = 0 }
		hidden_effect = { event_target:whale_probe_country = { set_faction_hostility = { set_hostile = yes } } }
	}
	option = { 
		name = STH_federation_story.2210.c 
		ai_chance = { factor = 0 }
		trigger = { event_target:whale_probe_country = { is_hostile = root.owner } }
		hidden_effect = { event_target:whale_probe_country = { set_faction_hostility = { set_hostile = yes } } }
	}
	option = { 
		name = STH_federation_story.2210.d 
		ai_chance = { factor = 0 modifier = { factor = 10 event_target:whale_probe_country = { is_hostile = root.owner } } }
		trigger = { event_target:whale_probe_country = { is_hostile = root.owner } }
		hidden_effect = { event_target:whale_probe_country = { set_faction_hostility = { set_hostile = no } } }
	}
}


planet_event = {
	id = STH_federation_story.2211
	title = "STH_federation_story.2211.name"
	desc = { 
		trigger = { NOT = { owner = { has_country_flag = whale_probe_communicated } } }
		text = "STH_federation_story.2211.desc_01" 
	}
	picture = sth_GFX_evt_whaleprobe2
	is_triggered_only = yes
	trigger = { event_target:whale_probe_fleet = { is_in_combat = no } }
	immediate = {
		change_variable = { which = "whale_probe_search" value = 10 }
		random_list = {
			10 = {
				random_tile = {
					limit = { has_building = yes }
					set_ruined = yes
				}
			}
			10 = {
				random_tile = {
					limit = { has_blocker = no }
					set_blocker = "tb_crater"
					kill_pop = yes
				}
			}
		}
		random_country = {
			limit = { has_country_flag = whale_probe_country }
			save_event_target_as = whale_probe_country
		}
	}
	option = { 
		name = STH_federation_story.2211.a 
		trigger = { event_target:whale_probe_country = { NOT = { is_hostile = root.owner } } }
		ai_chance = { factor = 0 modifier = { factor = 10 event_target:whale_probe_country = { NOT = { is_hostile = root.owner } } } }
		hidden_effect = { event_target:whale_probe_country = { set_faction_hostility = { set_hostile = no } } }
	}
	option = { 
		name = STH_federation_story.2211.b 
		trigger = { event_target:whale_probe_country = { NOT = { is_hostile = root.owner } } }
		ai_chance = { factor = 0 }
		hidden_effect = { event_target:whale_probe_country = { set_faction_hostility = { set_hostile = yes } } }
	}
	option = { 
		name = STH_federation_story.2211.c 
		ai_chance = { factor = 0 }
		trigger = { event_target:whale_probe_country = { is_hostile = root.owner } }
		hidden_effect = { event_target:whale_probe_country = { set_faction_hostility = { set_hostile = yes } } }
	}
	option = { 
		name = STH_federation_story.2211.c 
		ai_chance = { factor = 0 modifier = { factor = 10 event_target:whale_probe_country = { is_hostile = root.owner } } }
		trigger = { event_target:whale_probe_country = { is_hostile = root.owner } }
		hidden_effect = { event_target:whale_probe_country = { set_faction_hostility = { set_hostile = no } } }
	}
}




planet_event = {
	id = STH_federation_story.2212
	title = "STH_federation_story.2212.name"
	picture = sth_GFX_evt_whaleprobe2
	is_triggered_only = yes
	trigger = { event_target:whale_probe_fleet = { is_in_combat = no } }
	immediate = {
		change_pc = pc_ocean
		random_list = {
			20 = {
				random_tile = {
					limit = { has_building = yes }
					set_ruined = yes
				}
			}
			10 = {
				random_tile = {
					limit = { has_blocker = no }
					set_blocker = "tb_crater"
					kill_pop = yes
				}
			}
		}
		random_country = {
			limit = { has_country_flag = whale_probe_country }
			save_event_target_as = whale_probe_country
		}
		event_target:whale_probe_fleet = {
			queue_actions = {
				find_closest_system = {
					found_system = { move_to = THIS }
				}
				effect = {
					id = "STH_federation_story.2212.effect.2"
					delete_fleet = event_target:whale_probe_fleet
				}
			}
		}
	}
	option = { 
		name = STH_federation_story.2212.a 
		ai_chance = { factor = 1 }
		hidden_effect = { event_target:whale_probe_country = { set_faction_hostility = { set_hostile = no } } }
	}
	option = { 
		name = STH_federation_story.2212.b 
		ai_chance = { factor = 0 }
		trigger = { event_target:whale_probe_country = { NOT = { is_hostile = root.owner } } }
		hidden_effect = { event_target:whale_probe_country = { set_faction_hostility = { set_hostile = yes } } }
	}
	option = { 
		name = STH_federation_story.2212.c 
		ai_chance = { factor = 0 }
		trigger = { event_target:whale_probe_country = { is_hostile = root.owner } }
		event_target:whale_probe_country = { set_faction_hostility = { set_hostile = yes } }
		hidden_effect = { event_target:whale_probe_country = { set_faction_hostility = { set_hostile = yes } } }
	}
}


country_event = {
	id = STH_federation_story.2213
	title = "STH_federation_story.2213.name"
	desc = { 
		text = "STH_federation_story.2213.desc_01" 
	}
	fire_only_once = yes
	picture = sth_GFX_evt_whaleprobe1
	is_triggered_only = yes
	immediate = { }
	option = { name = STH_federation_story.2213.a }
}



fleet_event = {
	id = STH_federation_story.2220
	title = "STH_federation_story.2220.name"
	desc = { 
		text = "STH_federation_story.2220.desc_01" 
	}
	picture = sth_GFX_evt_whaleprobe3
	is_triggered_only = yes
	immediate = { 
	}
	option = { 
		name = STH_federation_story.2220.a 
		fleet_event = { id = STH_federation_story.2221 }
	}
}


fleet_event = {
	id = STH_federation_story.2221
	title = "STH_federation_story.2221.name"
	desc = { 
		text = "STH_federation_story.2221.desc_01" 
	}
	picture = sth_GFX_evt_whaleprobe3
	is_triggered_only = yes
	immediate = { 
	}
	option = { 
		name = STH_federation_story.2221.a 
		fleet_event = { id = STH_federation_story.2222 }
	}
}



fleet_event = {
	id = STH_federation_story.2222
	title = "STH_federation_story.2222.name"
	desc = { 
		text = "STH_federation_story.2222.desc_01" 
	}
	picture = sth_GFX_evt_whaleprobe8
	is_triggered_only = yes
	immediate = { 
	}
	option = { 
		name = STH_federation_story.2222.a 
		fleet_event = { id = STH_federation_story.2223 }
	}
	option = { 
		name = STH_federation_story.2222.b 
		fleet_event = { id = STH_federation_story.2230 }
	}
}


fleet_event = {
	id = STH_federation_story.2223
	title = "STH_federation_story.2223.name"
	desc = { text = "STH_federation_story.2223.desc_01" }
	picture = sth_GFX_evt_whaleprobe4
	is_triggered_only = yes
	immediate = { }
	option = { 
		name = STH_federation_story.2223.a 
		hidden_effect = {
			random_list = {
				10 = {
					modifier = { factor = 1.50 leader = { has_level = 2 } }
					modifier = { factor = 3.00 leader = { has_level = 3 } }
					modifier = { factor = 6.00 leader = { has_level = 4 } }
					fleet_event = { id = STH_federation_story.2224 }
				}
				10 = {
					modifier = { factor = 0.0 leader = { has_level = 5 } }
					fleet_event = { id = STH_federation_story.2225 }
				}
			}
		}
	}
	option = { 
		name = STH_federation_story.2223.b 
		hidden_effect = {
			random_list = {
				10 = {
					fleet_event = { id = STH_federation_story.2224 }
				}
				5 = {
					modifier = { factor = 0.0 leader = { has_level = 5 } }
					fleet_event = { id = STH_federation_story.2225 }
				}
			}
		}
	}
}


fleet_event = {
	id = STH_federation_story.2224
	title = "STH_federation_story.2224.name"
	desc = { text = "STH_federation_story.2224.desc_01" }
	picture = sth_GFX_evt_whaleprobe6
	is_triggered_only = yes
	immediate = { }
	option = { 
		name = STH_federation_story.2224.a 
		hidden_effect = { fleet_event = { id = STH_federation_story.2226 } }
	}
}



fleet_event = {
	id = STH_federation_story.2225
	title = "STH_federation_story.2225.name"
	desc = { text = "STH_federation_story.2225.desc_01" }
	picture = sth_GFX_evt_whaleprobe3
	is_triggered_only = yes
	immediate = { }
	option = { 
		name = STH_federation_story.2225.a 
		hidden_effect = { 
			small_timeline_change = yes 
			enable_special_project = { name = "WHALE_PROBE_1_PROJECT" location = event_target:timeTravelStar owner = root.owner }
			set_event_locked = no
		}
	}
}




fleet_event = {
	id = STH_federation_story.2230
	title = "STH_federation_story.2230.name"
	desc = { text = "STH_federation_story.2230.desc_01" }
	picture = sth_GFX_evt_whaleprobe5
	is_triggered_only = yes
	immediate = { }
	option = { 
		name = STH_federation_story.2230.a 
		hidden_effect = {
			random_list = {
				10 = {
					modifier = { factor = 1.50 leader = { has_level = 2 } }
					modifier = { factor = 3.00 leader = { has_level = 3 } }
					modifier = { factor = 6.00 leader = { has_level = 4 } }
					fleet_event = { id = STH_federation_story.2231 }
				}
				15 = {
					modifier = { factor = 0.0 leader = { has_level = 5 } }
					fleet_event = { id = STH_federation_story.2232 }
				}
			}
		}
	}
	option = { 
		name = STH_federation_story.2230.b 
		hidden_effect = {
			random_list = {
				10 = {
					fleet_event = { id = STH_federation_story.2231 }
				}
				10 = {
					modifier = { factor = 0.0 leader = { has_level = 5 } }
					fleet_event = { id = STH_federation_story.2232 }
				}
			}
		}
	}
}


fleet_event = {
	id = STH_federation_story.2231
	title = "STH_federation_story.2231.name"
	desc = { text = "STH_federation_story.2231.desc_01" }
	picture = sth_GFX_evt_whaleprobe6
	is_triggered_only = yes
	immediate = { }
	option = { 
		name = STH_federation_story.2231.a 
		hidden_effect = { fleet_event = { id = STH_federation_story.2226 } }
	}
}



fleet_event = {
	id = STH_federation_story.2232
	title = "STH_federation_story.2232.name"
	desc = { text = "STH_federation_story.2232.desc_01" }
	picture = sth_GFX_evt_whaleprobe3
	is_triggered_only = yes
	immediate = { }
	option = { 
		name = STH_federation_story.2232.a 
		hidden_effect = { 
			small_timeline_change = yes 
			enable_special_project = { name = "WHALE_PROBE_1_PROJECT" location = event_target:timeTravelStar owner = root.owner }
		}
		kill_leader = { type = scientist show_notification = no }
		set_event_locked = no
		delete_fleet = this
	}
}



fleet_event = {
	id = STH_federation_story.2226
	title = "STH_federation_story.2226.name"
	desc = { text = "STH_federation_story.2226.desc_01" }
	picture = sth_GFX_evt_whaleprobe3
	is_triggered_only = yes
	immediate = { }
	option = { 
		name = STH_federation_story.2226.a
		hidden_effect = {
			random_list = {
				10 = { 
					modifier = { factor = 1.50 leader = { has_level = 2 } }
					modifier = { factor = 2.00 leader = { has_level = 3 } }
					modifier = { factor = 3.00 leader = { has_level = 4 } }
				}
				10 = {
					modifier = { factor = 0.0 leader = { has_level = 4 } }
					modifier = { factor = 0.0 leader = { has_level = 5 } }
					small_timeline_change = yes
				}
				10 = {
					modifier = { factor = 0.0 leader = { has_level = 5 } }
					large_timeline_change = yes
				}
			}
			event_target:whale_probe_fleet = { fleet_event = { id = STH_federation_story.2250 days = 7 } }
			set_event_locked = no
		}
	}
}




fleet_event = {
	id = STH_federation_story.2250
	hide_window = yes
	trigger = { }
	is_triggered_only = yes
	immediate = {
		random_country = {
			limit = { 
				OR = {
					has_country_flag = united_federation_of_planets 
					earth_empires = yes
				}
			}
			save_event_target_as = united_federation_of_planets
			country_event = { id = STH_federation_story.2251 }
		}
		owner = { 
			set_faction_hostility = { set_hostile = no } 
			set_country_flag = whale_probe_resolved
		}
		queue_actions = {
			find_closest_system = { found_system = { move_to = THIS } }
			effect = {
				id = "STH_federation_story.2252.effect.2"
				ROOT = { 
					delete_fleet = this 
					owner = { destroy_country = yes }
				}
			}
			effect = {
				id = "STH_federation_story.2252.effect.3"
				event_target:united_federation_of_planets = {
					country_event = { id = STH_federation_story.2252 }
				}
			}
		}
	}
}



country_event = {
	id = STH_federation_story.2251
	title = "STH_federation_story.2251.name"
	desc = { text = "STH_federation_story.2251.desc_01" }
	picture = sth_GFX_evt_whaleprobe1
	is_triggered_only = yes
	immediate = { }
	option = { 
		name = STH_federation_story.2251.a 
		hidden_effect = { country_event = { id = STH_federation_story.2253 days = 90 random = 9 } }
	}
}


country_event = {
	id = STH_federation_story.2252
	title = "STH_federation_story.2252.name"
	desc = { text = "STH_federation_story.2252.desc_01" }
	picture = sth_GFX_evt_whaleprobe1
	is_triggered_only = yes
	immediate = { }
	option = { 
		name = STH_federation_story.2252.a 
		
	}
}

country_event = {
	id = STH_federation_story.2253
	title = "STH_federation_story.2253.name"
	desc = { text = "STH_federation_story.2253.desc_01" }
	picture = sth_GFX_evt_whaleprobe7
	is_triggered_only = yes
	immediate = { 
		random_planet = {
			limit = { has_planet_flag = sol_earth }
			save_event_target_as = sol_earth
		}
	}
	option = { 
		name = STH_federation_story.2253.a 
		event_target:sol_earth = {
			add_modifier = { modifier = pm_humpback_whales }
		}
		set_country_flag = whale_probe_crisis_resolved_peacefully
		remove_country_flag = wrath_of_khan_era_crisis_ongoing
	}
}


country_event = {
	id = STH_federation_story.2254
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		exists = from
		from = { has_country_flag = whale_probe_country }
		has_country_flag = whale_probe_crisis
	}
	immediate = {
		random_country = {
			limit = { has_country_flag = whale_probe_crisis }
			country_event = { id = STH_federation_story.2255 }
		}
		from = { destroy_country = yes }
	}
}


country_event = {
	id = STH_federation_story.2255
	title = "STH_federation_story.2255.name"
	desc = { text = "STH_federation_story.2255.desc_01" }
	picture = sth_GFX_evt_whaleprobe1
	is_triggered_only = yes
	immediate = {
		random_planet = {
			limit = { has_planet_flag = "whaleProbeTimeTravelStar" }
			save_event_target_as = timeTravelStar
		}
		if = {
			limit = { has_special_project = "WHALE_PROBE_1_PROJECT" }
			abort_special_project = { type = "WHALE_PROBE_1_PROJECT" location = event_target:timeTravelStar }
		}
		set_country_flag = whale_probe_crisis_resolved_forcefully
	}
	option = { 
		name = STH_federation_story.2255.a
		add_engineering_research = 3000
		add_minerals = 500
		add_energy = 250
	}
}
